<!-- FAQ Section -->
<section class="faq_section bg-slate-50" style="padding-top: {{ section.settings.padding_top }}px; padding-bottom: {{ section.settings.padding_bottom }}px;">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">

        <!-- Header -->
        <div class="text-center mb-8 sm:mb-12">
            {% if section.settings.section_title != blank %}
            <h2 class="text-3xl sm:text-4xl md:text-5xl font-bold text-slate-900 mb-4">
                {{ section.settings.section_title }}
            </h2>
            {% endif %}
            {% if section.settings.section_subtitle != blank %}
            <p class="text-slate-600 text-base sm:text-lg">
                {{ section.settings.section_subtitle }}
            </p>
            {% endif %}
        </div>

        <!-- Category Filter -->
        {% if section.blocks.size > 0 %}
            {% assign unique_categories = '' %}
            {% for block in section.blocks %}
                {% if block.type == 'faq_item' and block.settings.category != blank %}
                    {% assign category = block.settings.category | strip %}
                    {% unless unique_categories contains category %}
                        {% assign unique_categories = unique_categories | append: '|' | append: category %}
                    {% endunless %}
                {% endif %}
            {% endfor %}
            {% assign unique_categories = unique_categories | remove_first: '|' | split: '|' %}

            {% if unique_categories.size > 0 %}
            <div class="flex flex-wrap justify-center gap-3 mb-8 sm:mb-12">
                <button onclick="filterFAQ('all', this)" class="faq-filter-btn active px-6 py-2.5 rounded-full text-sm font-semibold transition-all duration-300 bg-slate-900 text-white hover:bg-slate-800" data-category="all">
                    Alle
                </button>
                {% for category in unique_categories %}
                <button onclick="filterFAQ('{{ category | escape }}', this)" class="faq-filter-btn px-6 py-2.5 rounded-full text-sm font-semibold transition-all duration-300 bg-white text-slate-700 border border-slate-300 hover:bg-slate-50 hover:border-slate-400" data-category="{{ category | escape }}">
                    {{ category }}
                </button>
                {% endfor %}
            </div>
            {% endif %}
        {% endif %}

        <!-- FAQ Accordion -->
        <div class="space-y-4">
            {% if section.blocks.size > 0 %}
                {% for block in section.blocks %}
                    {% case block.type %}
                        {% when 'faq_item' %}
                        <div class="faq-item bg-white rounded-lg border border-slate-200 overflow-hidden transition-all duration-300 hover:shadow-md"
                             {{ block.shopify_attributes }}
                             data-category="{{ block.settings.category | default: 'general' | escape }}">
                            <button onclick="toggleFAQ(this)" class="faq-question w-full flex items-start justify-between p-5 sm:p-6 text-left hover:bg-slate-50 transition-colors" aria-expanded="false" aria-controls="faq-answer-{{ block.id }}">
                                <div class="flex-1 pr-4">
                                    
                                    <span class="block text-slate-900 font-semibold text-base sm:text-lg">
                                        {{ block.settings.question }}
                                    </span>
                                </div>
                                <svg class="faq-icon w-6 h-6 text-slate-600 flex-shrink-0 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2" aria-hidden="true">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4" />
                                </svg>
                            </button>
                            <div id="faq-answer-{{ block.id }}" class="faq-answer max-h-0 overflow-hidden transition-all duration-300" role="region">
                                <div class="p-5 sm:p-6 pt-0 text-slate-600 text-sm sm:text-base leading-relaxed">
                                    {{ block.settings.answer }}
                                </div>
                            </div>
                        </div>
                    {% endcase %}
                {% endfor %}
            {% else %}
                <div class="text-center py-12 bg-white rounded-lg border border-slate-200">
                    <p class="text-slate-600 text-lg">No FAQs added yet. Add FAQ items in the theme editor.</p>
                </div>
            {% endif %}
        </div>
    </div>
</section>


<style>
/* Open FAQ item styling */
.faq-item.open .faq-question {
    background-color: #f8fafc !important;
}

.faq-item.open .faq-question:hover {
    background-color: #f8fafc !important;
}

/* Hidden FAQ items */
.faq-item.hidden {
    display: none;
}

/* Active filter button */
.faq-filter-btn.active {
    background-color: #1e293b !important;
    color: white !important;
    border-color: #1e293b !important;
}

.faq-filter-btn:not(.active):hover {
    background-color: #f8fafc !important;
}
</style>

<script>
// FAQ Filter Function
function filterFAQ(category, button) {
    const allItems = document.querySelectorAll('.faq-item');
    const allButtons = document.querySelectorAll('.faq-filter-btn');

    // Update active button
    allButtons.forEach(btn => btn.classList.remove('active'));
    button.classList.add('active');

    // Filter items
    allItems.forEach(item => {
        const itemCategory = item.getAttribute('data-category');

        if (category === 'all' || itemCategory === category) {
            item.classList.remove('hidden');
        } else {
            item.classList.add('hidden');
            item.classList.remove('open');
            const answer = item.querySelector('.faq-answer');
            const icon = item.querySelector('.faq-icon');
            const btn = item.querySelector('.faq-question');
            if (answer) answer.style.maxHeight = '0px';
            if (icon) icon.style.transform = 'rotate(0deg)';
            if (btn) btn.setAttribute('aria-expanded', 'false');
        }
    });

    // Open first visible FAQ
    const firstVisible = document.querySelector('.faq-item:not(.hidden)');
    if (firstVisible) {
        const firstButton = firstVisible.querySelector('.faq-question');
        const firstFAQ = firstVisible.querySelector('.faq-answer');
        const firstIcon = firstVisible.querySelector('.faq-icon');

        if (firstButton && firstFAQ && firstIcon) {
            setTimeout(() => {
                firstVisible.classList.add('open');
                firstButton.setAttribute('aria-expanded', 'true');
                firstFAQ.style.maxHeight = firstFAQ.scrollHeight + 50 + 'px';
                firstFAQ.style.overflow = 'visible';
                firstIcon.style.transform = 'rotate(45deg)';
            }, 100);
        }
    }
}

// FAQ Toggle Function
function toggleFAQ(button) {
    const faqItem = button.closest('.faq-item');
    const answer = faqItem.querySelector('.faq-answer');
    const icon = button.querySelector('.faq-icon');

    const isOpen = answer.style.maxHeight && answer.style.maxHeight !== '0px';

    // Close all other items
    const allItems = document.querySelectorAll('.faq-item');
    const allAnswers = document.querySelectorAll('.faq-answer');
    const allIcons = document.querySelectorAll('.faq-icon');
    const allButtons = document.querySelectorAll('.faq-question');

    allItems.forEach(item => item.classList.remove('open'));
    allAnswers.forEach(otherAnswer => {
        otherAnswer.style.maxHeight = '0px';
        otherAnswer.style.overflow = 'hidden';
    });
    allIcons.forEach(otherIcon => otherIcon.style.transform = 'rotate(0deg)');
    allButtons.forEach(btn => btn.setAttribute('aria-expanded', 'false'));

    // Toggle current item
    if (!isOpen) {
        faqItem.classList.add('open');
        answer.style.maxHeight = answer.scrollHeight + 50 + 'px';
        answer.style.overflow = 'visible';
        icon.style.transform = 'rotate(45deg)';
        button.setAttribute('aria-expanded', 'true');
    }
}

// Initialize on page load
document.addEventListener('DOMContentLoaded', function() {
    // Open first FAQ by default
    const firstItem = document.querySelector('.faq_section .faq-item');
    const firstButton = document.querySelector('.faq_section .faq-item .faq-question');
    const firstFAQ = document.querySelector('.faq_section .faq-item .faq-answer');
    const firstIcon = document.querySelector('.faq_section .faq-item .faq-icon');

    if (firstItem && firstButton && firstFAQ && firstIcon) {
        setTimeout(() => {
            firstItem.classList.add('open');
            firstButton.setAttribute('aria-expanded', 'true');
            firstFAQ.style.maxHeight = firstFAQ.scrollHeight + 50 + 'px';
            firstFAQ.style.overflow = 'visible';
            firstIcon.style.transform = 'rotate(45deg)';
        }, 100);
    }
});

// Make function globally available
window.toggleFAQ = toggleFAQ;
window.filterFAQ = filterFAQ;
</script>

{% schema %}
{
  "name": "FAQ Section",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "header",
      "content": "Section Settings"
    },
    {
      "type": "paragraph",
      "content": "Add FAQ items using the blocks below. Each FAQ can have a category for filtering."
    },
    {
      "type": "text",
      "id": "section_title",
      "label": "Section Title",
      "default": "Veelgestelde vragen"
    },
    {
      "type": "text",
      "id": "section_subtitle",
      "label": "Section Subtitle",
      "default": "Frequently asked questions"
    },
    {
      "type": "header",
      "content": "Section Layout"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Padding top",
      "default": 48
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Padding bottom",
      "default": 80
    }
  ],
  "blocks": [
    {
      "type": "faq_item",
      "name": "FAQ Item",
      "settings": [
        {
          "type": "text",
          "id": "category",
          "label": "Category",
          "default": "Algemeen",
          "info": "Category badge displayed above the question (e.g., Algemeen, Prijs, Technisch)"
        },
        {
          "type": "text",
          "id": "question",
          "label": "Question",
          "default": "Your question here?",
          "info": "The FAQ question/title"
        },
        {
          "type": "richtext",
          "id": "answer",
          "label": "Answer",
          "default": "<p>Your answer here.</p>",
          "info": "The FAQ answer content (supports rich text)"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "FAQ Section",
      "category": "Loopzo",
      "blocks": [
        {
          "type": "faq_item",
          "settings": {
            "category": "Algemeen",
            "question": "Voor wie is de Loopzo loopfiets geschikt?",
            "answer": "<p>De Loopzo is ontworpen voor volwassenen die extra stabiliteit en zekerheid zoeken tijdens het lopen, maar geen rollator willen gebruiken. Dankzij de lage instap (17 cm) en het feit dat u altijd met uw voeten bij de grond kunt, is hij ideaal voor mensen met verminderde mobiliteit, evenwichtsproblemen of gewrichtsklachten. Hij ondersteunt een lichaamsgewicht tot 120 kg.</p>"
          }
        },
        {
          "type": "faq_item",
          "settings": {
            "category": "Algemeen",
            "question": "Mag ik met de Loopzo winkels, musea en supermarkten in?",
            "answer": "<p>Ja, dat mag. De Loopzo is officieel erkend als medisch hulpmiddel. Dit betekent dat u de loopfiets overal mag gebruiken waar u normaal gesproken lopend naar binnen gaat, zoals in winkelcentra, musea, pretparken en ziekenhuizen. U geniet van dezelfde toegangsrechten als gebruikers van een rolstoel of rollator.</p>"
          }
        },
        {
          "type": "faq_item",
          "settings": {
            "category": "Algemeen",
            "question": "Past de Loopzo loopfiets in de auto?",
            "answer": "<p>Zeker. De Loopzo is speciaal ontworpen om makkelijk mee te nemen. Het frame weegt slechts 7,9 kg en zowel het stuur als het zadel zijn eenvoudig afneembaar zonder gereedschap. Hierdoor wordt de fiets zeer compact en past hij in de kofferbak van vrijwel elke auto.</p>"
          }
        },
        {
          "type": "faq_item",
          "settings": {
            "category": "Technisch",
            "question": "Is de Loopzo in hoogte verstelbaar?",
            "answer": "<p>Ja, de Loopzo heeft een universele maatvoering. Zowel het ergonomische zadel als het stuur zijn in hoogte en hoek verstelbaar. Hierdoor kan de fiets perfect worden afgesteld op uw lichaamslengte voor een optimale en comfortabele houding. Tijdens een proefrit of na levering kunt u dit eenvoudig zelf instellen.</p>"
          }
        },
        {
          "type": "faq_item",
          "settings": {
            "category": "Algemeen",
            "question": "Wat is het verschil tussen een loopfiets en een rollator?",
            "answer": "<p>Met een rollator leunt u en duwt u het gewicht vooruit, wat zwaar kan zijn voor polsen en rug. Op de Loopzo zit u, waardoor uw lichaamsgewicht wordt gedragen door het zadel. Dit ontlast uw heupen, knieën en enkels aanzienlijk. Hierdoor kunt u vaak langere afstanden afleggen en een hoger tempo aanhouden dan met een rollator.</p>"
          }
        },
        {
          "type": "faq_item",
          "settings": {
            "category": "Levering",
            "question": "Wat is de levertijd van de Loopzo?",
            "answer": "<p>Wij hanteren: op werkdagen voor 16:00 uur besteld, morgen in huis (voor Nederland en België). Voor leveringen naar Duitsland rekenen wij 2 werkdagen. U ontvangt een Track & Trace-code van onze partners PostNL of DPD om uw pakkette volgen.</p>"
          }
        },
        {
          "type": "faq_item",
          "settings": {
            "category": "Algemeen",
            "question": "Kan ik de Loopzo eerst uitproberen?",
            "answer": "<p>Ja, wij begrijpen dat u zeker wilt zijn van uw aankoop. U kunt gratis een proefrit aanvragen via onze website. Tijdens deze afspraak leggen we uit hoe de fiets werkt, stellen we hem voor u af en kunt u in alle rust ervaren hoe stabiel en wendbaar de Loopzo rijdt.</p>"
          }
        },
        {
          "type": "faq_item",
          "settings": {
            "category": "Garantie",
            "question": "Hoeveel garantie zit er op de loopfiets?",
            "answer": "<p>Wij staan achter de kwaliteit van ons product. Standaard bieden wij 2 jaar garantie op alle onderdelen. Als u uw fiets na aankoop registreert, wordt de garantie op het aluminium frame en de voorvork verlengd naar maar liefst 10 jaar.</p>"
          }
        },
        {
          "type": "faq_item",
          "settings": {
            "category": "Levering",
            "question": "Wordt de Loopzo rijklaar geleverd?",
            "answer": "<p>De Loopzo wordt zorgvuldig verpakt en grotendeels voorgemonteerd verzonden. U hoeft slechts enkele eenvoudige handelingen te verrichten (zoals het plaatsen van stuur en zadel) om de fiets gebruiksklaar te maken. Er wordt een duidelijke handleiding meegeleverd.</p>"
          }
        },
        {
          "type": "faq_item",
          "settings": {
            "category": "Retour",
            "question": "Wat als de Loopzo toch niet bevalt? (Retourneren)",
            "answer": "<p>U heeft een wettelijke bedenktijd van 14 dagen na ontvangst. Mocht de loopfiets niet aan uw verwachtingen voldoen, dan kunt u deze in originele staat en verpakking retourneren. De retourkosten bedragen €10,- voor Nederland en België. Zodra wij de fiets in goede staat hebben ontvangen, storten wij het aankoopbedrag binnen 7 werkdagen terug.</p>"
          }
        }
      ]
    }
  ]
}
{% endschema %}
