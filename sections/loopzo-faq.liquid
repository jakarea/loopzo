<!-- FAQ Section -->
<section class="faq_section bg-slate-50" style="padding-top: {{ section.settings.padding_top }}px; padding-bottom: {{ section.settings.padding_bottom }}px;">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">

        <!-- Header -->
        <div class="text-center mb-8 sm:mb-12">
            {% if section.settings.section_title != blank %}
            <h2 class="text-3xl sm:text-4xl md:text-5xl font-bold text-slate-900 mb-4">
                {{ section.settings.section_title }}
            </h2>
            {% endif %}
            {% if section.settings.section_subtitle != blank %}
            <p class="text-slate-600 text-base sm:text-lg">
                {{ section.settings.section_subtitle }}
            </p>
            {% endif %}
        </div>


        <!-- FAQ Accordion -->
        <div class="space-y-4">
            {% if section.blocks.size > 0 %}
                {% for block in section.blocks %}
                    {% case block.type %}
                        {% when 'faq_item' %}
                        <div class="faq-item bg-white rounded-lg border border-slate-200 overflow-hidden transition-all duration-300 hover:shadow-md"
                             {{ block.shopify_attributes }}>
                            <button onclick="toggleFAQ(this)" class="faq-question w-full flex items-start justify-between p-5 sm:p-6 text-left hover:bg-slate-50 transition-colors" aria-expanded="false" aria-controls="faq-answer-{{ block.id }}">
                                <div class="flex-1 pr-4">
                                    {% if block.settings.category != blank %}
                                    <span class="inline-block bg-slate-100 text-slate-700 text-xs font-semibold px-3 py-1 rounded-full mb-2">
                                        {{ block.settings.category }}
                                    </span>
                                    {% endif %}
                                    <span class="block text-slate-900 font-semibold text-base sm:text-lg">
                                        {{ block.settings.question }}
                                    </span>
                                </div>
                                <svg class="faq-icon w-6 h-6 text-slate-600 flex-shrink-0 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2" aria-hidden="true">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4" />
                                </svg>
                            </button>
                            <div id="faq-answer-{{ block.id }}" class="faq-answer max-h-0 overflow-hidden transition-all duration-300" role="region">
                                <div class="p-5 sm:p-6 pt-0 text-slate-600 text-sm sm:text-base leading-relaxed">
                                    {{ block.settings.answer }}
                                </div>
                            </div>
                        </div>
                    {% endcase %}
                {% endfor %}
            {% else %}
                <div class="text-center py-12 bg-white rounded-lg border border-slate-200">
                    <p class="text-slate-600 text-lg">No FAQs added yet. Add FAQ items in the theme editor.</p>
                </div>
            {% endif %}
        </div>
    </div>
</section>


<style>
/* Open FAQ item styling */
.faq-item.open .faq-question {
    background-color: #f8fafc !important;
}

.faq-item.open .faq-question:hover {
    background-color: #f8fafc !important;
}
</style>

<script>
// FAQ Toggle Function
function toggleFAQ(button) {
    const faqItem = button.closest('.faq-item');
    const answer = faqItem.querySelector('.faq-answer');
    const icon = button.querySelector('.faq-icon');

    const isOpen = answer.style.maxHeight && answer.style.maxHeight !== '0px';

    // Close all other items
    const allItems = document.querySelectorAll('.faq-item');
    const allAnswers = document.querySelectorAll('.faq-answer');
    const allIcons = document.querySelectorAll('.faq-icon');
    const allButtons = document.querySelectorAll('.faq-question');

    allItems.forEach(item => item.classList.remove('open'));
    allAnswers.forEach(otherAnswer => {
        otherAnswer.style.maxHeight = '0px';
        otherAnswer.style.overflow = 'hidden';
    });
    allIcons.forEach(otherIcon => otherIcon.style.transform = 'rotate(0deg)');
    allButtons.forEach(btn => btn.setAttribute('aria-expanded', 'false'));

    // Toggle current item
    if (!isOpen) {
        faqItem.classList.add('open');
        answer.style.maxHeight = answer.scrollHeight + 50 + 'px';
        answer.style.overflow = 'visible';
        icon.style.transform = 'rotate(45deg)';
        button.setAttribute('aria-expanded', 'true');
    }
}

// Initialize on page load
document.addEventListener('DOMContentLoaded', function() {
    // Open first FAQ by default
    const firstItem = document.querySelector('.faq_section .faq-item');
    const firstButton = document.querySelector('.faq_section .faq-item .faq-question');
    const firstFAQ = document.querySelector('.faq_section .faq-item .faq-answer');
    const firstIcon = document.querySelector('.faq_section .faq-item .faq-icon');

    if (firstItem && firstButton && firstFAQ && firstIcon) {
        setTimeout(() => {
            firstItem.classList.add('open');
            firstButton.setAttribute('aria-expanded', 'true');
            firstFAQ.style.maxHeight = firstFAQ.scrollHeight + 50 + 'px';
            firstFAQ.style.overflow = 'visible';
            firstIcon.style.transform = 'rotate(45deg)';
        }, 100);
    }
});

// Make function globally available
window.toggleFAQ = toggleFAQ;
</script>

{% schema %}
{
  "name": "FAQ Section",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "header",
      "content": "Section Settings"
    },
    {
      "type": "paragraph",
      "content": "Add FAQ items using the blocks below. Each FAQ can have a category for filtering."
    },
    {
      "type": "text",
      "id": "section_title",
      "label": "Section Title",
      "default": "Veelgestelde vragen"
    },
    {
      "type": "text",
      "id": "section_subtitle",
      "label": "Section Subtitle",
      "default": "Frequently asked questions"
    },
    {
      "type": "header",
      "content": "Section Layout"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Padding top",
      "default": 48
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Padding bottom",
      "default": 80
    }
  ],
  "blocks": [
    {
      "type": "faq_item",
      "name": "FAQ Item",
      "settings": [
        {
          "type": "text",
          "id": "category",
          "label": "Category",
          "default": "Algemeen",
          "info": "Category badge displayed above the question (e.g., Algemeen, Prijs, Technisch)"
        },
        {
          "type": "text",
          "id": "question",
          "label": "Question",
          "default": "Your question here?",
          "info": "The FAQ question/title"
        },
        {
          "type": "richtext",
          "id": "answer",
          "label": "Answer",
          "default": "<p>Your answer here.</p>",
          "info": "The FAQ answer content (supports rich text)"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "FAQ Section",
      "category": "Loopzo",
      "blocks": [
        {
          "type": "faq_item",
          "settings": {
            "category": "Algemeen",
            "question": "Wanneer kan een driewielfiets voor mij de oplossing zijn?",
            "answer": "<p>Een driewielfiets is ideaal voor mensen die moeite hebben met balanceren op een gewone fiets. Dit kan bijvoorbeeld door ouderdom, een lichamelijke beperking, of revalidatie.</p>"
          }
        },
        {
          "type": "faq_item",
          "settings": {
            "category": "Algemeen",
            "question": "Kan ik een proefrit maken op een Loopzo fiets?",
            "answer": "<p>Ja, zeker! Wij bieden gratis proefritten aan. U kunt contact met ons opnemen om een afspraak te maken.</p>"
          }
        },
        {
          "type": "faq_item",
          "settings": {
            "category": "Prijs",
            "question": "Wat zijn de kosten van een aangepaste fiets?",
            "answer": "<p>De prijs varieert afhankelijk van het model en de aanpassingen. Onze fietsen starten vanaf â‚¬1.599.</p>"
          }
        }
      ]
    }
  ]
}
{% endschema %}
