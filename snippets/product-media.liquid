{% comment %}
  Renders product media (images, videos, models)

  Accepts:
  - media: {Object} Product Media object
  - class: {String} CSS classes (optional)

  Usage:
  {% render 'product-media', media: media, class: 'w-full h-full object-contain' %}
{% endcomment %}

{%- if media.media_type == 'image' -%}
  <img
    srcset="
      {%- if media.preview_image.width >= 350 -%}{{ media.preview_image | image_url: width: 350 }} 350w,{%- endif -%}
      {%- if media.preview_image.width >= 550 -%}{{ media.preview_image | image_url: width: 550 }} 550w,{%- endif -%}
      {%- if media.preview_image.width >= 750 -%}{{ media.preview_image | image_url: width: 750 }} 750w,{%- endif -%}
      {%- if media.preview_image.width >= 1100 -%}{{ media.preview_image | image_url: width: 1100 }} 1100w,{%- endif -%}
      {%- if media.preview_image.width >= 1500 -%}{{ media.preview_image | image_url: width: 1500 }} 1500w,{%- endif -%}
      {%- if media.preview_image.width >= 2048 -%}{{ media.preview_image | image_url: width: 2048 }} 2048w,{%- endif -%}
      {{ media.preview_image | image_url }} {{ media.preview_image.width }}w
    "
    sizes="(min-width: 1024px) 50vw, 100vw"
    src="{{ media.preview_image | image_url: width: 1100 }}"
    alt="{{ media.alt | default: media.preview_image.alt | escape }}"
    loading="lazy"
    width="{{ media.preview_image.width }}"
    height="{{ media.preview_image.height }}"
    class="{{ class }}"
    data-media-id="{{ media.id }}"
  >
{%- elsif media.media_type == 'video' or media.media_type == 'external_video' -%}
  <div class="{{ class }} relative">
    {%- if media.media_type == 'external_video' -%}
      {%- if media.host == 'youtube' -%}
        <iframe
          src="https://www.youtube.com/embed/{{ media.external_id }}"
          class="w-full h-full"
          frameborder="0"
          allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture"
          allowfullscreen
        ></iframe>
      {%- elsif media.host == 'vimeo' -%}
        <iframe
          src="https://player.vimeo.com/video/{{ media.external_id }}"
          class="w-full h-full"
          frameborder="0"
          allow="autoplay; fullscreen; picture-in-picture"
          allowfullscreen
        ></iframe>
      {%- endif -%}
    {%- else -%}
      {{ media | media_tag: class: class, autoplay: false, loop: false, controls: true }}
    {%- endif -%}
  </div>
{%- elsif media.media_type == 'model' -%}
  {{ media | media_tag: class: class, image_size: '1100x' }}
{%- else -%}
  <img
    src="{{ media.preview_image | image_url: width: 1100 }}"
    alt="{{ media.alt | default: media.preview_image.alt | escape }}"
    loading="lazy"
    class="{{ class }}"
  >
{%- endif -%}
